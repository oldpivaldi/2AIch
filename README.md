# Проект по дисциплине "Нейроинформатика"

## ChMOCoder - онлайн чат с LLM моделью

## Авторы

| ФИО                          | Группа      |
| ---------------------------- | ----------- |
| Павлов Иван Дмитриевич       | М80-407Б-21 |
| Крючков Артемий Владимирович | М80-407Б-21 |
| Лютоев Илья Александрович    | М80-407Б-21 |

### Описание

**ChMOCoder** — это интерактивный онлайн-чат, в основе которого лежит мощная языковая модель LLaMA. Проект создан для тех, кто стремится эффективно решать задачи программирования, получать экспертные советы по коду или просто экспериментировать с идеями. С помощью ChMOCoder вы можете в реальном времени общаться с искусственным интеллектом, способным понимать контекст, генерировать релевантные ответы и помогать улучшать качество вашего кода. Простой и удобный интерфейс облегчает взаимодействие с моделью и позволяет адаптировать её работу под ваши конкретные задачи — будь то обучение, отладка или поиск вдохновения.

### Бизнес цель проекта

**Бизнес-цель ChMOCoder** заключается в создании универсального инструмента для разработчиков и компаний, который сочетает в себе интерактивное обучение, помощь в разработке программного обеспечения и повышение производительности. Основные направления:

1. **Оптимизация процессов разработки**: Предоставление разработчикам быстрого доступа к решениям задач, улучшение качества и скорости написания кода, устранение ошибок на ранних стадиях.

2. **Поддержка обучения и развития навыков**: Включение в процесс обучения как новичков, так и опытных разработчиков через интерактивные объяснения, примеры и рекомендации.

3. **Снижение затрат на разработку и обучение**: Замена дорогостоящих консультаций и обучения специалистами на автоматизированные решения с поддержкой искусственного интеллекта.

ChMOCoder нацелен на широкую аудиторию — от индивидуальных разработчиков и образовательных учреждений до крупных корпораций, стремящихся автоматизировать рутинные задачи, повысить квалификацию своих специалистов и внедрить новые технологии в процесс разработки.

### ML-цель проекта

1. **Генерация качественного кода**: Обеспечение способности модели генерировать оптимальный, понятный и эффективный код для решения задач на различных языках программирования.

2. **Отладка и исправление ошибок**: Разработка функционала для анализа кода, выявления ошибок и предложений по их исправлению с объяснением причин.

3. **Адаптация к разным уровням знаний**: Внедрение механизмов, позволяющих модели адаптировать ответы в зависимости от уровня подготовки пользователя — от начинающего до профессионала.

### Архитектура (схема C4)

### Обоснование архитектуры

### Объяснение выбора используемого стека

### Описать сети (DMZ, Secure zone и т.д.)

## Конфигурация проекта

1. Создать ssl-сертификаты на свой домен (или самоподписные для localhost) и добавить их [сюда](https://github.com/oldpivaldi/ChMOCoder/tree/main/src/proxy/ssl) согласно инструкции.

2. Скачать модель llama с расширением .gguf и добавить ее [сюда](https://github.com/oldpivaldi/ChMOCoder/tree/main/src/text_model_api/repo) согласно инструкции.

3. [Сюда](https://github.com/oldpivaldi/ChMOCoder/blob/main/src/text_model_api/.env) в поле TEXT_MODEL_NAME вписать название файла модели из п.2.

4. [Здесь](https://github.com/oldpivaldi/ChMOCoder/blob/main/src/proxy/nginx.conf) вписать свой домен в директиву server_name.

5. Также изменить конфиги сервисов под свой домен [здесь](https://github.com/oldpivaldi/ChMOCoder/blob/main/src/frontend/.env), [здесь](https://github.com/oldpivaldi/ChMOCoder/blob/main/src/backend/.env) и [здесь](https://github.com/oldpivaldi/ChMOCoder/blob/main/src/text_model_api/.env).

## Запуск проекта

1. Проверить, что порты 80, 443, 8000, 8001, 5174 и 6380 свободны. Также возможно убрать mapping портов (кроме 80 и 443) в манифестах.

2. Воспользоваться инструкциями по сборке через docker-desktop или k8s (minicube).

3. В любом случае сервис находится по адресу https://<ваш_домен> (по умолчанию https://localhost).

## Инструкция по сборке в docker-compose

1. Находясь в корневой директории проекта, прописать данную команду: 
```
docker compose -f ./docker-compose.yml up --build -d
```

## Инструкция по сборке в k8s

1. Запустить minikube:

```
minikube start --driver=docker
```

2. Копировать volume:

```
tar -czf proxy-ssl.tar.gz -C ./src/proxy .
```

```
minikube cp proxy-ssl.tar.gz /home/docker/
```

```
minikube ssh -- tar -xzf /home/docker/proxy-ssl.tar.gz -C /home/docker/
```

```
tar -czf model-repo.tar.gz -C ./src/text_model_api/repo .
```

```
minikube cp model-repo.tar.gz /home/docker/
```

```
minikube ssh -- tar -xzf /home/docker/model-repo.tar.gz -C /home/docker/
```

3. Зайти в директорию с манифестами:

```
cd k8s-manifests
```

4. Использовать локальный образ Docker внутри minikube:

```
eval $(minikube docker-env)
```

5. Собрать все образы:

Proxy:

```
docker build -t proxy-image ../src/proxy
```

Frontend:

```
docker build -t frontend-image ../src/frontend
```

Backend:

```
docker build -t backend-image ../src/backend
```

Model:

```
docker build -t text-model-api-image ../src/text_model_api
```

6. Применить манифесты:

```
kubectl apply -f namespace.yaml
kubectl apply -f redis-config.yaml
kubectl apply -f redis-deployment.yaml
kubectl apply -f backend-deployment.yaml
kubectl apply -f frontend-deployment.yaml
kubectl apply -f proxy-deployment.yaml
kubectl apply -f text-model-api.yaml
```

7. Прокинуть порт 443 до minikube

```
sudo kubectl --kubeconfig /home/<ваш_пользователь>/.kube/config port-forward -n chmocoder service/proxy 443:443
```

8. Снова использовать docker-desktop (после завершения)

```
eval $(minikube docker-env --unset)
```
